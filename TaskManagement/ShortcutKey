Sub InsertRowAbove()

    ActiveCell.EntireRow.Insert

End Sub

Sub InsertRowBelow()

    ActiveCell.Offset(1).EntireRow.Insert

End Sub

Sub HideSelectedRows()

    If TypeName(Selection) <> "Range" Then Exit Sub
    
    If Selection.Address <> Selection.EntireColumn.Address Then
        Selection.EntireRow.Hidden = True
    Else
        Selection.EntireColumn.Hidden = True
    End If

End Sub

Sub UnHideSelectedRows()

    If TypeName(Selection) <> "Range" Then Exit Sub
    
    If Selection.Address <> Selection.EntireColumn.Address Then
        Selection.EntireRow.Hidden = False
    Else
        Selection.EntireColumn.Hidden = False
    End If
    
End Sub

Sub ClearSelectedCells()

    If TypeName(Selection) <> "Range" Then Exit Sub
    makeKeyEvent "{DELETE}"
    
End Sub

Sub DeleteSelectedRows()

    If TypeName(Selection) <> "Range" Then Exit Sub
    
    If Selection.Address <> Selection.EntireColumn.Address Then
        Selection.EntireRow.Select
        makeKeyEvent "^{-}"
    Else
        makeKeyEvent "^{-}"
    End If
    
End Sub

Sub CopySelectedRows()

    If TypeName(Selection) <> "Range" Then Exit Sub
    
    If Selection.Address <> Selection.EntireColumn.Address Then
        Selection.EntireRow.Copy
    Else
        Selection.EntireColumn.Copy
    End If
    
End Sub

Sub CutSelectedRows()

    If TypeName(Selection) <> "Range" Then Exit Sub
    
    If Selection.Address <> Selection.EntireColumn.Address Then
        Selection.EntireRow.Cut
    Else
        Selection.EntireColumn.Cut
    End If
    
End Sub

Sub InsertSelectedRows()

    If TypeName(Selection) <> "Range" Then Exit Sub
    
    makeKeyEvent "^{OemSemicolon}"
    makeKeyEvent "^{ENTER}"
    
End Sub

Sub SetToday()

    If TypeName(Selection) <> "Range" Then Exit Sub
    Selection.Value = Date

End Sub

Sub ToggleReadOnly()
    
    With ActiveWorkbook
        If .ReadOnly Then
            .ChangeFileAccess Mode:=xlReadWrite
        Else
            .ChangeFileAccess Mode:=xlReadOnly
        End If
    End With
    
End Sub

Sub NextSheet()

    If ActiveSheet.Index <> Worksheets.Count Then
        ActiveSheet.Next.Activate
    Else
        Worksheets(1).Activate
    End If
End Sub

Sub PreviousSheet()

    If ActiveSheet.Index <> 1 Then
        ActiveSheet.Previous.Activate
    Else
        Worksheets(Worksheets.Count).Activate
    End If
    
End Sub

Sub IndentUp()

    If TypeName(Selection) <> "Range" Then Exit Sub
    Selection.InsertIndent insertamount:=1
    
End Sub

Sub IndentDown()
    
    If TypeName(Selection) <> "Range" Then Exit Sub
    
    For Each c In Selection
        If c.IndentLevel <> 0 Then
            c.InsertIndent insertamount:=-1
        End If
    Next
    
End Sub

Sub HideDones()

    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    
    For i = 3 To Cells(Rows.Count, "D").End(xlUp).Row
    
        If Cells(i, "D") <> "" And Cells(i, "D") <> "固定" Then
            Rows(i).Hidden = True
        End If
        
    Next
    
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic

End Sub

Sub ShowTitles()

    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual

    For i = 3 To Cells(Rows.Count, "B").End(xlUp).Row
    
        If Left(Cells(i, "B"), 1) = "■" Then
            Rows(i).Hidden = False
        End If
    
    Next
    
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic
    
End Sub

